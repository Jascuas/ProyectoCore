@using Oberon.Models;
@model Oberon.Models.ProductoTalla

@section scripts{ 
    <script>
        var tallas =  @Html.Raw(Json.Serialize(@ViewBag.Tallas));
        
        var precio = $("#precio").text();

        $(document).ready(function () {
            cargarUnidades();
            $("#id_tallas").change(function () {
                cargarUnidades();
            });
            
            $("#unidades").change(function () {
                $("#precio").text(precio * $("#unidades").val());
            });
        });

        function cargarUnidades() {
            var id_talla = $("#id_tallas option:selected").val();
            var html = "";
            $(tallas).each(function (index, element) {
                if (element.id_Talla == id_talla) {
                    for (i = 1; i <= element.stock; i++)
                        html += "<option value='" + i + "'>" + i + "</option>";
                }
            });
            $("#unidades").html(html);
            $("#precio").text(precio * $("#unidades").val());
        }
    </script>
} 
<div class="container mt-5 pt-5">
    <section class="my-5">


        <!-- Grid row -->
        <div class="row">

            <!-- Grid column -->
            <div class="col-lg-6">

                <!-- Featured image -->
                <div class=" mb-lg-0 mb-4">
                    <img class="view overlay rounded z-depth-2 img-fluid img-" src="~/images/Productos/@Model.producto.Imagen" alt="Sample image">
                    @*<a>
                    <div class="mask rgba-white-slight"></div>
                </a>*@
                </div>

            </div>
            <!-- Grid column -->
            <!-- Grid column -->
            <div class="col-lg-6">
                <!-- Post title -->
                <h6 class="grey-text">Tipo: </h6>
                <h3 class="font-weight-bold mb-3"><strong>@Model.producto.Nombre</strong></h3>
                @using (Html.BeginForm())
                {
                    @Html.AntiForgeryToken()
                    <input type="hidden" id="id_producto" name="id_producto" class="text-hide" value="@Model.producto.Id_Producto">
                    <h6 class="grey-text">Tallas: </h6>
                    <select class='browser-default  custom-select-sm' id="id_tallas" name="id_talla" >
                        @foreach (Talla t in @Model.tallas)
                        {
                            @if (t.Stock != 0)
                            {
                                @if (@Model.tallas.Count() > 1)
                                {
                                    <option value="@t.Id_Talla" data-toggle="tooltip" data-placement="right">@t.Size </option>
                                }
                                else
                                {
                                    <option value="@t.Id_Talla" selected> Talla unica </option>;
                                }
                            }
                            else
                            {
                                <option value="@t.Id_Talla" data-toggle="tooltip" data-placement="right" disabled>Talla @t.Size - Agotada </option>
                            }
                        }
                    </select>
                    <h6 class="grey-text">Unidades: </h6>
                    <select class='browser-default  custom-select-sm' id="unidades" name="unidades"></select>
                    <!-- Excerpt -->
                    <!-- Post data -->
                    <h6 class="grey-text">Precio: </h6>
                    <h5 class="text-primary"><span id="precio">@Model.producto.Precio</span>€</h5>
                    <br />
                    <!-- Read more button -->
                    <button type="submit" class="btn btn-primary">Comprar</button>
                    <hr />
                    <h6 class="grey-text">Detalles: </h6>
                    <p>
                        @Model.producto.Detalles
                    </p>

                }
            </div>

            <!-- Grid column -->
            <div class="col-lg-6 mt-2">

                <h6 class="grey-text">Informacion: </h6>
                <p>
                    @Model.producto.Informacion
                </p>
            </div>
        </div>
            <!-- Grid row -->



</section>
    <!-- Section: Blog v.1 -->
</div>